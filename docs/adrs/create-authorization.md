
# Авторизация.Начало.

## Status
---
Предложение

## Context
---
Необходимо реализовать сервис-фасад и сервис авторизации.

## Decision
### Шаблоны микросервисов
---
Для создания авторизационного сервис используем шаблон Calabonga.Microservice.IdentityModule.  
Для создания сервис-фасада используем шаблон Calabonga.Microservice.Module.  
Шаблоны используются для общей схемы всех микросервисов проекта.  
[Identity и простой шаблоны](https://github.com/Calabonga/Microservice-Template/tree/master/AspNetCore%20v6.0/MinimalAPI)

### Фасад-сервис
---
Методы фасад-сервиса, за исключением методов авторизации, являются закрытыми для неавторизованных пользователей.

### Kafka messaging
---
Сервис-фасад (producer) отправляет сообщение {логин и пароль} в Kafka в топик "auth".  
Микросервис авторизации (consumer) получает сообщение и проверяет наличие пользователя,
если пользователь существует, то генерируется токен и отправляется сообщение в кафку {токен},
иначе отправляется {токен=empty}. 
Сервис-фасад получает данные из Kafka и возращает ответ {OperationResult} клиенту.

### Proto
---
хранение proto контрактов в корне репозитория в папке shared/protos 

## Consequences
---
1. Для создания любого нового микросервиса используется шаблоны приведенные выше.  
2. Все микросервисы для сериализации/дисериализации сообщений используют proto контракты из папки shared/protos.