# Сервис транзакций

## Status
Предложение

## Context
Необходимо реализовать сервис транзакций, который будет отвечать за сохранение информации обо всех транзакциях, которые были произведены, а также сообщать о новых

## Dicision
### Новый микросервис
---
Так как данный сервис будет служить хранилищем выполненных транзакций, то разделять его на несколько (даже логичесих) не имеет смысла.  
Будет создан новый сервис на базе упрощенного шаблона c MongoDb и Kafka

### Логика работы
---
1. Сервис по Kafka (топик `Orders_Candidates`) получает сообщение от сервиса заявок, в котором находятся две заявки, которые были выбраны как наиболее подходящие
2. Сервис сохраняет у себя в базе новую запись о транзакции между этими двумя заявками
3. Сервис отправляет в Kafka (топик `Transactions`) сообщение, что была создана и исполнена траназкция между двумя заявками  

На сообщения из топика Transactions реагирует сервис заявок:
1. Меняет статусы заявок на `Executed`
2. Отправляет в топик `Orders_Executed` сообщение об выполнении этих двух заявок

Баланс и портфель получают сообщения из `Orders_Executed` и снимают/добавляют ресурсы пользователя


## Consequences
1. Сервис недоступен для прямого обращения
2. Сервис абсолютно независим от других сервисов